# REQ-018 问题确认结果

| 序号 | 原始问题 | 用户确认 | 最终决策 | 确认时间 |
|------|----------|----------|----------|----------|
| 1 | 岗位编码唯一性 | 全局唯一 | 岗位编码必须在整个系统中唯一 | 2026-02-26 |

## 详细回答

### Q1: 岗位编码唯一性

- **用户回答:** 全局唯一
- **最终决策:** 岗位编码必须在整个系统中唯一
- **影响:** 数据库将在`code`字段上建立唯一索引
- **校验:** 服务层在新增/更新前必须校验编码唯一性

### Q2: 禁用岗位行为

- **用户回答:** 指定了自定义行为
- **最终决策:** 
  - 禁用岗位类型仅阻止新员工绑定
  - 已存在的员工继续正常运行
  - 仅当没有员工绑定时才允许删除岗位类型
- **影响:** 
  - 禁用: 仅更新状态，无级联影响
  - 删除: 必须校验`employee_count == 0`后才允许删除
- **注意:** API需要支持DELETE接口用于删除岗位

### Q5: 删除支持

- **用户回答:** 仅当没有员工绑定时才允许删除
- **最终决策:** 
  - DELETE接口将添加到API中
  - 删除前校验没有员工与该岗位类型关联
  - 如有员工绑定则返回错误
- **影响:** 需要添加`DELETE /admin/api/v1/job-types/{jobTypeId}`接口

### Q3: 岗位字段定义

- **用户回答:** 指定了自定义字段
- **最终决策:** 岗位实体将包含以下字段：
  | 字段 | 类型 | 说明 |
  |-------|------|-------------|
  | id | BIGINT | 主键 |
  | code | VARCHAR(32) | 唯一编码，全局唯一 |
  | name | VARCHAR(64) | 显示名称 |
  | status | TINYINT | 0-禁用，1-启用 |
  | sort_order | INT | 显示排序 |
  | description | VARCHAR(255) | 描述文本 |
  | is_default | TINYINT | 0-否，1-是（新员工默认岗位） |
  | employee_count | INT | 关联员工数量（只读） |
  | created_at | DATETIME | 创建时间 |
  | updated_at | DATETIME | 更新时间 |
- **影响:** 
  - 数据库表: `aim_job_type`
  - 同时只能有一个岗位类型的`is_default = 1`
  - `employee_count`是用于列表展示的计算字段

### Q4: 列表查询条件

- **用户回答:** 指定了自定义过滤条件
- **最终决策:** 列表查询将支持：
  | 参数 | 类型 | 说明 |
  |-----------|------|-------------|
  | keyword | String | 名称和描述模糊搜索 |
  | pageNum | Integer | 页码（默认1） |
  | pageSize | Integer | 每页条数（默认10，最大100） |
- **默认排序:** sort_order升序, created_at降序
- **返回字段:** 所有字段包括employee_count
- **影响:** 
  - MyBatis动态WHERE条件查询
  - 关键字搜索在name和description上使用`LIKE '%keyword%'`
  - **注意:** 不需要状态过滤 - 返回所有状态

